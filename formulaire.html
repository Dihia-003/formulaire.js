<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire</title>
    <link rel="stylesheet" href="formulaire.css">
</head>
<body>
    <h2>Formulaire d'inscription</h2>
    <form id="registerForm">
        <label for="nom">Nom :</label>
        <input type="text" id="nom" name="nom" required><br><br>

        <label for="password">Mot de passe :</label>
        <input type="password" id="password" name="password" required><br><br>

        <label for="confirmPassword">Confirmer le mot de passe :</label>
        <input type="password" id="confirmPassword" name="confirmPassword" required><br><br>

        <button type="submit">S'inscrire</button>
    </form>
    <p>Déjà un compte ? <a href="login.html">Connectez-vous ici</a></p>

    <script>
        document.getElementById("registerForm").addEventListener("submit", async function(e) {
            e.preventDefault(); 

            // Récupération des valeurs du formulaire
            let nom = document.getElementById("nom").value.trim();
            let password = document.getElementById("password").value.trim();
            let confirmPassword = document.getElementById("confirmPassword").value.trim();

            //Vérification des champs vides
            if (nom === "" || password === "" || confirmPassword === "") {
                alert("Veuillez remplir tous les champs.");
                return;
            }

            // Vérification de la longueur du mot de passe
            if (password.length < 6) {
                alert("Le mot de passe doit contenir au moins 6 caractères.");
                return;
            }

            if (password !== confirmPassword) {
                alert("Les mots de passe ne correspondent pas.");
                return;
            }

            // Hachage du mot de passe avec SHA-256
            const hashedPassword = await hashPassword(password);

            //Enregistrement des informations dans le stockage local
            localStorage.setItem("nomUtilisateur", nom);
            localStorage.setItem("mdpUtilisateur", hashedPassword);

            alert("Inscription réussie ! Vous pouvez maintenant vous connecter.");
            window.location.href = "login.html";
        });

        async function hashPassword(password) {
            const encoder = new TextEncoder();
            const data = encoder.encode(password);
            const hash = await crypto.subtle.digest("SHA-256", data);
            return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, "0")).join("");
        }
    </script>
</body>
</html>
